/*
 * SoundGraph.java
 *
 * Created on June 30, 2003, 3:46 PM
 */
package eecs.audio;

import java.awt.*;
import java.awt.image.BufferedImage;


/**
 * DOCUMENT ME!
 *
 * @author DK8685
 */
public class SoundGraph extends javax.swing.JPanel {
  /** DOCUMENT ME! */
  Image img;

  /** DOCUMENT ME! */
  byte[] data = null;

  /**
   * Creates new form SoundGraph
   */
  public SoundGraph() {
    this("Recording", 300, 300);
  }

  /**
   * Creates a new SoundGraph object.
   *
   * @param title DOCUMENT ME!
   * @param width DOCUMENT ME!
   * @param height DOCUMENT ME!
   */
  public SoundGraph(String title, int width, int height) {
    initComponents(width, height);

    if (getBorder() instanceof javax.swing.border.TitledBorder) {
      ((javax.swing.border.TitledBorder) getBorder()).setTitle(title);
    }

    img = new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB);
  }

  /**
   * DOCUMENT ME!
   *
   * @param data DOCUMENT ME!
   */
  public void setData(byte[] data) {
    this.data = data;

    Graphics g = img.getGraphics();
    double width = this.getWidth();
    double height = this.getHeight();
    int max = 0;
    int min = Integer.MAX_VALUE;

    for (int i = 0; i < data.length; i++) {
      if (data[i] < min) {
        min = data[i];
      }

      if (data[i] > max) {
        max = data[i];
      }
    }

    double scaleY = height / (max - min);
    double scaleX = width / data.length;
    double mid = height / 2.0;
    g.setColor(Color.black);

    int lastX = 0;
    double total = 0;
    int count = 0;
    int prevData = 0;

    for (int i = 1; i < data.length; i++) {
      g.drawRect((int) (i * scaleX), (int) (data[i] + mid), 1, 1);
    }

    repaint();
  }

  /**
   * DOCUMENT ME!
   *
   * @param g DOCUMENT ME!
   */
  public void paintComponent(Graphics g) {
    super.paintComponent(g);

    if (data == null) {
      return;
    }
    g.drawImage(img, 15, 20, getWidth() - 30, getHeight() - 35, Color.white,
      null);
  }

  /**
   * This method is called from within the constructor to initialize the form.
   * WARNING: Do NOT modify this code. The content of this method is always
   * regenerated by the Form Editor.
   *
   * @param width DOCUMENT ME!
   * @param height DOCUMENT ME!
   */
  private void initComponents(int width, int height) {
    setLayout(new java.awt.BorderLayout());

    setBorder(new javax.swing.border.TitledBorder(null, "",
        javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION,
        javax.swing.border.TitledBorder.DEFAULT_POSITION,
        new java.awt.Font("Dialog", 1, 12)));
    setMinimumSize(new java.awt.Dimension(width, height));
    setPreferredSize(new java.awt.Dimension(width, height));
    setSize(new java.awt.Dimension(width, height));
  }
}
